<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Income Statement</title>
	<!-- Include Bootstrap CSS for styling if you like -->
	<link rel="stylesheet" href="/webjars/bootstrap/5.3.0/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="/webjars/datatables/1.13.5/css/jquery.dataTables.min.css" />
	<style>
		.wrapper {
			display: flex;
			flex-direction: column;
			min-height: 100vh;
			/* Ensure wrapper takes full viewport height */
		}

		.container-fluid {
			flex: 1;
			/* Ensures it takes up remaining space pushing footer (if any) down */
		}
	</style>
</head>

<body>
	<div class="wrapper">
		<header th:replace="fragments/header :: header"></header>
		<div class="container-fluid">
			<div class="row flex-nowrap">

				<div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-white min-vh-100"
					th:replace="fragments/sidebar :: sidebar"></div>

				<section class="col-md-10 p-0">

					<nav th:replace="fragments/yearselect :: navbar"></nav>
					<div class="container">
						<ul class="nav nav-tabs" id="expenseTabs">
							<li class="nav-item">
								<a class="nav-link active" id="report-tab" data-bs-toggle="tab"
									href="#report">Report</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" id="transactions-tab" data-bs-toggle="tab"
									href="#transactions">Transaction</a>
							</li>
							<li class="nav-item" th:each="ledger : ${accounts_ledgers}">
								<a class="nav-link" th:id="${ledger.account.accountNumber+'-tab'}" data-bs-toggle="tab"
									th:href="${'#'+ledger.account.accountNumber}" th:text="${ledger.account.name}">Transaction</a>
							</li>

						</ul>
						<div class="tab-content" id="suppliersTabsContent">
							<div class="tab-pane fade show active" id="report" role="tabpanel"
								aria-labelledby="report-tab">
								<div th:replace="fragments/bilan :: bilan"></div>
							</div>
							<div class="tab-pane fade" id="transactions" role="tabpanel"
								aria-labelledby="transaction-tab">
								<div th:replace="fragments/ledger-table :: ledger-table('transactions',${ledgerEntries})"></div>
							</div>
							<div th:each="ledger : ${accounts_ledgers}" 
							class="tab-pane fade" 
							th:id="${ledger.account.accountNumber}" 
							role="tabpanel"
							th:aria-labelledby="${ledger.account.accountNumber+'-tab'}">
								<div th:replace="fragments/ledger-table :: ledger-table(${ledger.account.name},${ledger.entries})"></div>
							</div>

						</div>
				</section>
			</div>
		</div>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
		<script src="/webjars/jquery/3.6.4/jquery.min.js"></script>
		<script src="/webjars/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
		<script src="/webjars/popper.js/2.11.7/umd/popper.min.js"></script>
		<script src="/webjars/datatables/1.13.5/js/jquery.dataTables.min.js"></script>
		<script src="/js/ledger.js"></script>
		<script>
			$(document).ready(function () {
				$('#download').click(function () {
					var element = document.getElementById('report');

					var opt = {
						margin: 10,
						filename: 'myfile.pdf',
						image: {type: 'jpeg', quality: 0.98},
						html2canvas: {scale: 2},
						jsPDF: {unit: 'mm', format: 'a4', orientation: 'portrait'}
					};

					html2pdf().from(element).set(opt).save();
				});
			});

		</script>
</body>

</html>